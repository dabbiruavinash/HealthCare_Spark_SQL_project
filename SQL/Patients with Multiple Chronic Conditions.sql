select p.patient_id, p.first_name, p.last_name, count(Distinct mr.diagnosis) as condition_count from patients p join medical_records mr on p.patient_id = mr.patient_id where mr.visit_date >= add_months(trunc(sysdate), -12) and mr.diagnosis in ('Hypertension', 'Diabetes', 'Asthma', 'COPD', 'Heart Disease') group by p.patient_id, p.first_name, p.last_name having count(Distinct mr.diagnosis) >= 3 order by condition_count desc;
